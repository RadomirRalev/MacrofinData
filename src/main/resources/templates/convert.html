<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <title>Converter</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Styles -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/picker.min.css" th:href="@{/css/picker.min.css}"/>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

    <!-- Scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="../static/js/picker.min.js" th:src="@{/js/picker.min.js}"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#amount').picker();
            $('#span').picker();
            $('#ex-search').picker({search: true});
            $('#ex-search1').picker({search: true});
        });
    </script>
    <script>

        function formatInput(e) {
            let element = document.getElementById(e.id);
            forbidNonNumericChars();
            document.getElementById(e.id).value = addCommas(element);
        }

        function forbidNonNumericChars() {
            let number = document.getElementById('amount');
            number.onkeydown = function (e) {
                if (!((e.keyCode > 95 && e.keyCode < 106)
                    || (e.keyCode > 47 && e.keyCode < 58)
                    || e.keyCode === 8
                    || e.keyCode === 108
                    || e.keyCode === 110
                    || e.keyCode === 190)) {
                    return false;
                }
                if ((number.value.split(".").length) > 1 && (e.keyCode === 108
                    || e.keyCode === 110
                    || e.keyCode === 190)) {
                    return false;
                }
            }
        }

        function removeTrailingZeros(finalVal) {
            finalVal = finalVal.replace(/^0+/, '');
            return finalVal;
        }

        function addCommas(ele) {
            ele = ele.value.split(',').join('');
            return ele.replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g, ",");
        }

        function eliminateCommas(e) {
            let ele = document.getElementById(e).value;
            let finalVal = ele.replace(/^0+(\d)|(\d)0+$/gm, '$1$2');
            finalVal = finalVal.split(',',).join('');
            finalVal = finalVal.split('-',).join('');
            document.getElementById(e).value = finalVal;
        }
    </script>
</head>
<body style="font-size: 22px; font-family: Ebrima, sans-serif">
<nav class="navbar navbar-default"
     style="margin-bottom: unset; border: none; border-radius: unset; background-color: #343a40; height: 60px">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">
                <img alt="Brand"
                     src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAB+0lEQVR4AcyYg5LkUBhG+1X2PdZGaW3btm3btm3bHttWrPomd1r/2Jn/VJ02TpxcH4CQ/dsuazWgzbIdrm9dZVd4pBz4zx2igTaFHrhvjneVXNHCSqIlFEjiwMyyyOBilRgGSqLNF1jnwNQdIvAt48C3IlBmHCiLQHC2zoHDu6zG1iXn6+y62ScxY9AODO6w0pvAqf23oSE4joOfH6OxfMoRnoGUm+de8wykbFt6wZtA07QwtNOqKh3ZbS3Wzz2F+1c/QJY0UCJ/J3kXWJfv7VhxCRRV1jGw7XI+gcO7rEFFRvdYxydwcPsVsC0bQdKScngt4iUTD4Fy/8p7PoHzRu1DclwmgmiqgUXjD3oTKHbAt869qdJ7l98jNTEblPTkXMwetpvnftA0LLHb4X8kiY9Kx6Q+W7wJtG0HR7fdrtYz+x7iya0vkEtUULIzCjC21wY+W/GYXusRH5kGytWTLxgEEhePPwhKYb7EK3BQuxWwTBuUkd3X8goUn6fMHLyTT+DCsQdAEXNzSMeVPAJHdF2DmH8poCREp3uwm7HsGq9J9q69iuunX6EgrwQVObjpBt8z6rdPfvE8kiiyhsvHnomrQx6BxYUyYiNS8f75H1w4/ISepDZLoDhNJ9cdNUquhRsv+6EP9oNH7Iff2A9g8h8CLt1gH0Qf9NMQAFnO60BJFQe0AAAAAElFTkSuQmCC">
            </a>
        </div>
    </div>
</nav>

<!--<div class="jumbotron jumbotron-fluid" style="background-color: darkcyan">-->
<div class="container">
    <h1 class="display-4" style="color:#343a40; text-align: center">CURRENCY CONVERTER</h1>
    <hr class="mb-4">
</div>
<div class="container">
    <h4 class="display-4" style="color:#343a40; text-align: left">Convert currencies based on today's official
        exchange rates as set by the European Central Bank (ECB). Currency converter makes calculations based on the
        euro rate. The list includes all currencies with an official rate by the ECB and is automatically updated on a
        daily basis, together with the update of the ECB foreign exchange rates.
    </h4>
    <hr class="mb-4">
</div>
<div class="container" style="margin: auto;">
    <div>
        <form class="form-inline" th:action="@{/convert}" th:object="${currenciesList}" method="get">
            <div class="form-group">
                <input type="text" maxlength="16" id="amount" th:name="amount" required
                       class="form-control h-100"
                       placeholder="Amount"
                       style="font-size: x-large; font-weight: bold; border-radius: unset; border: 1px solid #666;"
                       onkeyup="formatInput(this)">
            </div>
            <div class="form-group">
                <select class="form-control" name="basic" id="ex-search" th:name="code1">
                    <option th:text="Euro" th:value="EUR"></option>
                    <option th:each="currency : ${currenciesList}" th:value="${currency.code}"
                            th:text="${currency.code} + ' - ' + ${currency.currencyName}">
                    </option>
                </select>
            </div>
            <div class="form-group">
                <select class="form-control" name="basic" id="ex-search1" th:name="code2">
                    <option th:text="Euro" th:value="EUR"></option>
                    <option th:each="currency : ${currenciesList}" th:value="${currency.code}"
                            th:text="${currency.code} + ' - ' + ${currency.currencyName}">
                    </option>
                </select>
            </div>
            <button onclick="eliminateCommas('amount')" class="btn button" type="submit">Convert
            </button>
        </form>
        <hr class="mb-4">
        <div class="container">
            <div th:if="${currencies != null}" style="width: 80%; margin: 0 auto;">
                <div th:if="${currencyFrom} == ${currencyTo}" style="width: 50%; margin: 0 auto;">
                    <p class="h4"
                       th:text="${currencyFrom.code} + ' ' + ${#numbers.formatDecimal(amount, 1, 'COMMA', 4, 'POINT')} + ' = '"
                       style="color:#343a40; text-align: center"></p>
                    <p class="h1"
                       th:text="${currencyTo.code} + ' ' + ${#numbers.formatDecimal(amount, 1, 'COMMA', 4, 'POINT')}"
                       style="color:#343a40; font-size: 60px; text-align: center"></p>
                    <div th:if="${currencyTo.code} != EUR">
                        <p class="h5"
                           th:text="'1 EUR = ' + ${currencyTo.code} + ' ' + ${currencyTo.value}"
                           style="color:#343a40; text-align: center"></p>
                        <p th:text="'last updated on ' + ${currencyTo.updatedOn} + ' Eastern European Time (EET)'"
                           style="color:#343a40; text-align: right"></p>
                    </div>
                    <div th:unless="${currencyTo.code} != EUR">
                        <p class="h5"
                           th:text="'1 EUR = ' + ${currencyFrom.code} + ' ' + ${currencyFrom.value}"
                           style="color:#343a40; text-align: center"></p>
                        <p th:text="'last updated on ' + ${currencyFrom.updatedOn} + ' Eastern European Time (EET)'"
                           style="color:#343a40; text-align: right"></p>
                    </div>
                </div>
                <div class="container" style="width: 50%; text-align: center">
                    <div>
                        <img style="max-height:30px; max-width:30px; overflow: hidden" th:src="${currencyFrom.picture}"
                             alt="image"
                             src="">
                        <span th:text="${currencyFrom.code} + ' ' + ${#numbers.formatDecimal(amount, 1, 'COMMA', 4, 'POINT')}"></span>
                    </div>
                </div>
                <div class="container" style="width: 50%; text-align: center"><span th:text="' = '"></span></div>
                <div class="container" style="max-width: 80%; text-align: center">
                    <div>
                        <img style="overflow: hidden; margin-bottom: 30px"
                             th:src="${currencyTo.picture}"
                             alt="image"
                             id="flagTo"
                             src="">
                        <span class="h1" id="span"
                              th:text="${currencyTo.code} + ' ' + ${#numbers.formatDecimal(currencies, 1, 'COMMA', 4, 'POINT')}"
                              style="color:#343a40; text-align: center"></span>
                    </div>
                    <hr class="mb-4">
                </div>
                <div id="line4" class="col-lg-12">
                    <div class="col-sm-12">
                        <div th:if="${currencyTo.code} != EUR">
                            <p class="h3" th:text="'1 EUR = ' + ${currencyTo.code} + ' ' + ${currencyTo.value}"
                               style="color:#343a40; text-align: center"></p>
                            <p th:text="'last updated on ' + ${currencyTo.updatedOn} + ' Eastern European Time (EET)'"
                               style="color:#343a40; text-align: right"></p>
                        </div>
                    </div>
                </div>
                <div th:unless="${currencyTo.code} != EUR">
                    <p class="h3"
                       th:text="'1 EUR = ' + ${currencyFrom.code} + ' ' + ${currencyFrom.value}"
                       style="color:#343a40; text-align: center"></p>
                    <p th:text="'last updated on ' + ${currencyFrom.updatedOn} + ' Eastern European Time (EET)'"
                       style="color:#343a40; text-align: right"></p>
                </div>
                <hr class="mb-4">
            </div>
        </div>
    </div>
</div>
<!--</div>-->
<div class="container">
    <div class="row">
        <div class="col-sm-3" th:each="currency : ${currenciesList}">
            <div th:if="${currency.code} != EUR">
                <img style="max-height:40px; max-width:40px; overflow: hidden" th:src="${currency.picture}" alt="image"
                     src="">
                <span th:value="${currency.code}"
                      th:text="${currency.code}"></span>
                <span style="font-weight: bold" th:value="${currency.value}" th:text="${currency.value}"></span>
            </div>
        </div>
    </div>
</div>
<div>
</div>
<footer class="footer" style="position: absolute">
    <div class="container">
        <span class="text-muted">Place sticky footer content here.</span>
    </div>
</footer>
</body>
</html>
